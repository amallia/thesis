\chapter{Codice sorgente}

\newcommand{\sourcecode}[2][]{%
    \lstinputlisting[caption={\texttt{\detokenize{#2}}},#1]{#2}%
}

\section{Esempio di stored procedure in Redis}

Il seguente listato mostra una stored procedure scritta in LUA che dato un insieme ordinato
\verb|paying-users| in cui le stringhe sono gli ID degli utenti di un sistema, e il punteggio
associato è il totale speso dall'utente nell'applicazione, calcola qual è la media di spesa degli
utenti ``premium'', cioè che hanno speso più di €1000.

Si veda \ref{redislua} per maggiori informazioni.

\sourcecode[language={[5.0]Lua}]{code/zsetaverage.lua}


\section{Calcolo dell'errore di cardinalit\'a di un filtro di Bloom}

Il seguente listato effettua una simulazione di calcolo dell'errore di cardinalità in un filtro
di Bloom di 8192 bit, con 2 funzioni di hash.

Si veda \ref{sec:bloomcard} per maggiori informazioni.

\sourcecode[language=Python]{code/cardinality.py}


\section{Calcolo dei parametri ottimali di un filtro di Bloom}

I seguenti listati effettuano il calcolo dei parametri ottimali per un filtro di Bloom da 64 MiB.

Si veda \ref{sec:bloomparms} per maggiori informazioni.

\sourcecode[language=Python]{code/bloomparms1.py}
\sourcecode[language=Python]{code/bloomparms2.py}


